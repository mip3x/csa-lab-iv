# csa-lab-iv

4-ая лабораторная работа в рамках дисциплины "Архитектура компьютерных систем"

`Вариант`: `forth | cisc | harv | hw | tick | binary | trap | port | pstr | prob1 | vector`

## Оглавление

- [Язык программирования](#Язык-программирования)
    - [Синтаксис](#Синтаксис)
    - [Семантика](#Семантика)
- [Организация памяти](#Организация-памяти)

## Язык программирования

### Синтаксис

Форма Бэкуса-Науэра:

```ebnf
<program> ::= <bindings> <body>

<bindings> ::= <binding>*

<binding> ::= <definition> | <declaration>

<definition> ::= ":" <ident> <body> ";"

<body> ::= <statement>*

<statement> ::= <number>
            | <string>
            | <ident>
            | <if_stmt>
            | <loop_stmt>
            | <trap_block>
            | <require>

<declaration> ::= "var" <ident> (<number>)?
            | "str" <ident> <string>
            | <number> "const" <ident>
            | <number> "alloc" <ident>
            | "vector" <number> ":" <ident>

<if_stmt> ::= "if" <body> ("else" <body>)? "then"

<loop_stmt> ::= "begin" <body> "until"
            | <number> "times" <body> "next"

<trap_block> ::= "trap" <ident> <body> "endtrap"

<require> ::= "#require" <string>

<number> ::= <decimal> | <hexadecimal>

<decimal> ::= <digit>+                           

<hexadecimal> ::= "0x" <hex_digit>+                  

<ident> ::= <letter> (<letter> | <digit> | "_")*

<string> ::= [^"]

<letter> ::= [a-zA-Z]
<digit> ::= [0-9]
<hex_digit> ::= <digit> | [a-fA-F]
```

### Семантика

- Подробное описание команд находится в [этом файле](./docs/prog-lang.md) документации.
- Все данные имеют глобальную область видимости
- Стратегия вычислений: стековая
- Типизация: бестиповая (отсутствует)
- Нотация: обратная польская (постфиксная). Оператор идёт после операндов

#### Особенности реализации

- Каждое слово разделено пробелом

## Организация памяти

- Модель памяти соответствует **гарвардской архитектуре**
- **Память данных**:
    - Хранит строковые литералы, переменные и последовательные блоки данных
    - Строковые литералы упакованы неплотно, хранятся в памяти в формате `pascal`-строки
    > Неплотная упаковка косвенно обусловлена отсутствием типизации в `Forth`: все значения хранятся в ячейках фиксированного размера. Возможно несколько решений. Приведу некоторые:
    > - реализация команд побайтового доступа для строковых литералов и блоков последовательной памяти
    > - реализация неявных типов в трансляторе
    > Так или иначе, эти решения усложнили бы архитектуру, что было принято не делать (в данной ситуации)
    - Размер машинного слова - **32 бита**
    - Поддерживыемые типы адресации:
        - **Абсолютная**
        - **Косвенная**
- **Память команд**:
    - Хранит инструкции для выполнения
    - Размер машинного слова - **32 бита**
    - Поддерживыемые типы адресации:
        - **Абсолютная**
